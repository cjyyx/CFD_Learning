#! https://zhuanlan.zhihu.com/p/599619784
# 计算流体力学（三）差分方程

[上一篇文章](https://zhuanlan.zhihu.com/p/599416488)给出了离散化和有限差分的概念，并将有限差分作用于弦振动方程，得到一个差分方程，最后利用Python程序计算了这个差分方程，给出了弦振动问题的数值解。这篇文章将深入探讨差分方程。

考虑一维热传导方程
$$
\frac{\partial T}{\partial t}-\alpha \frac{\partial^2 T}{\partial x^2}=0\tag{3-1}
$$
其解为$T(t,x)$，离散化后变为$T_{n,i}$，或者换种写法$T^n_{i}$。有限差分作用于偏微分方程后，得到差分方程
$$
\frac{T_{i}^{n+1}-T_{i}^{n}}{\Delta t}=\alpha \frac{T_{i+1}^{n}-2 T_{i}^{n}+T_{i-1}^{n}}{(\Delta x)^{2}}\tag{3-2}
$$
且该差分方程**截断误差**为$\text{O}\left[\Delta t,(\Delta x)^{2}\right]$。回顾一下，有限差分求解的含义是指用差分方程表示偏微分方程，然后求解差分方程，得到解在每个离散网格点上的数值，而这些网格点都分布在所求解的物理区域内。而**截断误差正是差分方程和偏微分方程的区别**。当网格点的数量趋于无限多，即$\Delta x\to 0,\Delta t\to 0$时，截断误差趋于零，差分方程趋于原偏微分方程，可以说偏微分方程的这个有限差分表示是**相容的**。**假如差分方程是相容的，假如求解差分方程的数值方法是稳定的，再假如边界条件已经用合理的数值方法进行了处理，那么差分方程的数值解就应该能够代表微分方程的解析解，至少是在截断误差的范围之内是这样。**

## 显式方法

继续研究公式(3-2)，就像上一篇文章那样，将其转换为
$$
T_{i}^{n+1}=T_{i}^{n}+\alpha \frac{\Delta t}{(\Delta x)^{2}}\left(T_{i+1}^{n}-2 T_{i}^{n}+T_{i-1}^{n}\right)\tag{3-3}
$$
于是可以根据$T_{i}^{n}$求出$T_{i}^{n+1}$，进而求解差分方程。这就是**显式方法**。

![时间推进](PasteImage/2023-01-17-14-01-31.png)

可以这样定义：显式方法中每一个差分方程只包含一个未知数，从而这个未知数可以用直接计算的方式显式地求解。显式方法是最简单的方法。

## 隐式方法

这里引入一个新的差分公式，其被称为克兰克-尼科尔森格式
$$
\left(\frac{\partial^2 T}{\partial x^2}\right)_{n,i}=\frac{\frac{T_{i+1}^{n+1}+T_{i+1}^{n}}{2}-2\left(\frac{T_{i}^{n+1}+T_{i}^{n}}{2}\right)+\frac{T_{i-1}^{n+1}+T_{i-1}^{n}}{2}}{(\Delta x)^{2}}\tag{3-4}
$$

代入公式(3-1)，则有
$$
\frac{T_{i}^{n+1}-T_{i}^{n}}{\Delta t}=\alpha \frac{\frac{T_{i+1}^{n+1}+T_{i+1}^{n}}{2}-2\left(\frac{T_{i}^{n+1}+T_{i}^{n}}{2}\right)+\frac{T_{i-1}^{n+1}+T_{i-1}^{n}}{2}}{(\Delta x)^{2}}\tag{3-5}
$$

如果想用第$n$个时间层上的值计算出第$n+1$个时间层上的值，那么已知量有$T_{i-1}^{n},T_{i}^{n},T_{i+1}^{n}$，未知量有$T_{i-1}^{n+1},T_{i}^{n+1},T_{i+1}^{n+1}$。这意味着需要联立方程组才能求出第$n+1$个时间层上的值。对于排列在同一时间层所有网格点上的未知量，必须将它们联立起来同时求解，才能求出这些未知量，这种方法就定义为**隐式方法**。

显式方法和隐式方法的优缺点如下。

1.显式方法

优点：方法的建立及编程相对简单。

缺点：取定的$\Delta x,\Delta t$必须小于稳定性条件对它提出的限制。在某些情形，$\Delta t$必须很小，才能保持稳定性，这需要巨大的计算量。

2.隐式方法

优点：用大得多的$\Delta t$值也能保持稳定性。

缺点：方法的建立和编程更复杂。而且，由于每一时间步的计算通常需要大量的矩阵运算，每一时间步的计算机运行的时间要比显式方法长得多。另外，$\Delta t$取大的值，截断误差就大，精度低。

## 误差分析

继续考虑热传导方程(3-1)，即
$$
\frac{\partial T}{\partial t}-\alpha \frac{\partial^2 T}{\partial x^2}=0\tag{3-1}
$$
及其差分方程(3-2)，即
$$
\frac{T_{i}^{n+1}-T_{i}^{n}}{\Delta t}=\alpha \frac{T_{i+1}^{n}-2 T_{i}^{n}+T_{i-1}^{n}}{(\Delta x)^{2}}\tag{3-2}
$$

这个偏微分方程数值解的误差为多少？首先，可以称呼这个数值解的误差的误差为**数值误差**。







<未完继续>